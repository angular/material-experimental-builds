{"version":3,"file":"mdc-progress-bar.js","sources":["../../../../../../src/material-experimental/mdc-progress-bar/progress-bar.ts","../../../../../../src/material-experimental/mdc-progress-bar/module.ts","../../../../../../src/material-experimental/mdc-progress-bar/public-api.ts","../../../../../../src/material-experimental/mdc-progress-bar/index.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  ViewEncapsulation,\n  ElementRef,\n  NgZone,\n  Optional,\n  Inject,\n  Input,\n  Output,\n  EventEmitter,\n  AfterViewInit,\n  OnDestroy,\n} from '@angular/core';\nimport {CanColor, CanColorCtor, mixinColor} from '@angular/material/core';\nimport {ANIMATION_MODULE_TYPE} from '@angular/platform-browser/animations';\nimport {ProgressAnimationEnd} from '@angular/material/progress-bar';\nimport {MDCLinearProgressAdapter, MDCLinearProgressFoundation} from '@material/linear-progress';\nimport {Subscription, fromEvent, Observable} from 'rxjs';\nimport {filter} from 'rxjs/operators';\nimport {Directionality} from '@angular/cdk/bidi';\nimport {Platform} from '@angular/cdk/platform';\n\n// Boilerplate for applying mixins to MatProgressBar.\n/** @docs-private */\nclass MatProgressBarBase {\n  constructor(public _elementRef: ElementRef) { }\n}\n\nconst _MatProgressBarMixinBase: CanColorCtor & typeof MatProgressBarBase =\n    mixinColor(MatProgressBarBase, 'primary');\n\nexport type ProgressBarMode = 'determinate' | 'indeterminate' | 'buffer' | 'query';\n\n@Component({\n  selector: 'mat-progress-bar',\n  exportAs: 'matProgressBar',\n  host: {\n    'role': 'progressbar',\n    'aria-valuemin': '0',\n    'aria-valuemax': '100',\n    '[attr.aria-valuenow]': '(mode === \"indeterminate\" || mode === \"query\") ? null : value',\n    '[attr.mode]': 'mode',\n    'class': 'mat-mdc-progress-bar',\n    '[class._mat-animation-noopable]': '_isNoopAnimation',\n  },\n  inputs: ['color'],\n  templateUrl: 'progress-bar.html',\n  styleUrls: ['progress-bar.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class MatProgressBar extends _MatProgressBarMixinBase implements AfterViewInit, OnDestroy,\n  CanColor {\n\n  constructor(public _elementRef: ElementRef<HTMLElement>,\n              private _ngZone: NgZone,\n              private _platform: Platform,\n              @Optional() private _dir?: Directionality,\n              @Optional() @Inject(ANIMATION_MODULE_TYPE) public _animationMode?: string) {\n    super(_elementRef);\n    this._isNoopAnimation = _animationMode === 'NoopAnimations';\n    if (_dir) {\n      this._dirChangeSubscription = _dir.change.subscribe(() => this._syncFoundation());\n    }\n  }\n\n  /** Implements all of the logic of the MDC progress bar. */\n  private _foundation: MDCLinearProgressFoundation | undefined;\n\n  /** Adapter used by MDC to interact with the DOM. */\n  private _adapter: MDCLinearProgressAdapter = {\n    addClass: (className: string) => this._rootElement.classList.add(className),\n    forceLayout: () => this._platform.isBrowser && this._rootElement.offsetWidth,\n    removeAttribute: (name: string) => this._rootElement.removeAttribute(name),\n    setAttribute: (name: string, value: string) => this._rootElement.setAttribute(name, value),\n    hasClass: (className: string) => this._rootElement.classList.contains(className),\n    removeClass: (className: string) => this._rootElement.classList.remove(className),\n    setPrimaryBarStyle: (styleProperty: string, value: string) => {\n      (this._primaryBar.style as any)[styleProperty] = value;\n    },\n    setBufferBarStyle: (styleProperty: string, value: string) => {\n      (this._bufferBar.style as any)[styleProperty] = value;\n    }\n  };\n\n  /** Flag that indicates whether NoopAnimations mode is set to true. */\n  _isNoopAnimation = false;\n\n  /** Value of the progress bar. Defaults to zero. Mirrored to aria-valuenow. */\n  @Input()\n  get value(): number { return this._value; }\n  set value(v: number) {\n    this._value = clamp(v || 0);\n    this._syncFoundation();\n  }\n  private _value = 0;\n\n  /** Buffer value of the progress bar. Defaults to zero. */\n  @Input()\n  get bufferValue(): number { return this._bufferValue || 0; }\n  set bufferValue(v: number) {\n    this._bufferValue = clamp(v || 0);\n    this._syncFoundation();\n  }\n  private _bufferValue = 0;\n\n  private _rootElement: HTMLElement;\n  private _primaryBar: HTMLElement;\n  private _bufferBar: HTMLElement;\n\n  /**\n   * Event emitted when animation of the primary progress bar completes. This event will not\n   * be emitted when animations are disabled, nor will it be emitted for modes with continuous\n   * animations (indeterminate and query).\n   */\n  @Output() animationEnd = new EventEmitter<ProgressAnimationEnd>();\n\n  /** Reference to animation end subscription to be unsubscribed on destroy. */\n  private _animationEndSubscription = Subscription.EMPTY;\n\n  /** Subscription to when the layout direction changes. */\n  private _dirChangeSubscription = Subscription.EMPTY;\n\n  /**\n   * Mode of the progress bar.\n   *\n   * Input must be one of these values: determinate, indeterminate, buffer, query, defaults to\n   * 'determinate'.\n   * Mirrored to mode attribute.\n   */\n  @Input()\n  get mode(): ProgressBarMode { return this._mode; }\n  set mode(value: ProgressBarMode) {\n    // Note that we don't technically need a getter and a setter here,\n    // but we use it to match the behavior of the existing mat-progress-bar.\n    this._mode = value;\n    this._syncFoundation();\n  }\n  private _mode: ProgressBarMode = 'determinate';\n\n  ngAfterViewInit() {\n    const element = this._elementRef.nativeElement;\n\n    this._rootElement = element.querySelector('.mdc-linear-progress') as HTMLElement;\n    this._primaryBar = element.querySelector('.mdc-linear-progress__primary-bar') as HTMLElement;\n    this._bufferBar = element.querySelector('.mdc-linear-progress__buffer-bar') as HTMLElement;\n\n    this._foundation = new MDCLinearProgressFoundation(this._adapter);\n    this._foundation.init();\n    this._syncFoundation();\n\n    // Run outside angular so change detection didn't get triggered on every transition end\n    // instead only on the animation that we care about (primary value bar's transitionend)\n    this._ngZone.runOutsideAngular((() => {\n      this._animationEndSubscription =\n          (fromEvent(this._primaryBar, 'transitionend') as Observable<TransitionEvent>)\n            .pipe(filter(((e: TransitionEvent) => e.target === this._primaryBar)))\n            .subscribe(() => {\n              if (this.mode === 'determinate' || this.mode === 'buffer') {\n                this._ngZone.run(() => this.animationEnd.next({value: this.value}));\n              }\n            });\n    }));\n  }\n\n  ngOnDestroy() {\n    if (this._foundation) {\n      this._foundation.destroy();\n    }\n    this._animationEndSubscription.unsubscribe();\n    this._dirChangeSubscription.unsubscribe();\n  }\n\n  /** Syncs the state of the progress bar with the MDC foundation. */\n  private _syncFoundation() {\n    const foundation = this._foundation;\n\n    // Don't sync any state if we're not in a browser, because MDC uses some window APIs.\n    if (foundation && this._platform.isBrowser) {\n      const direction = this._dir ? this._dir.value : 'ltr';\n      const mode = this.mode;\n\n      foundation.setReverse(direction === 'rtl' ? mode !== 'query' : mode === 'query');\n      foundation.setDeterminate(mode !== 'indeterminate' && mode !== 'query');\n\n      // Divide by 100 because MDC deals with values between 0 and 1.\n      foundation.setProgress(this.value / 100);\n\n      if (mode === 'buffer') {\n        foundation.setBuffer(this.bufferValue / 100);\n      }\n    }\n  }\n}\n\n/** Clamps a value to be between two numbers, by default 0 and 100. */\nfunction clamp(v: number, min = 0, max = 100) {\n  return Math.max(min, Math.min(max, v));\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {NgModule} from '@angular/core';\nimport {MatCommonModule} from '@angular/material/core';\nimport {MatProgressBar} from './progress-bar';\n\n@NgModule({\n  exports: [MatProgressBar, MatCommonModule],\n  declarations: [MatProgressBar],\n})\nexport class MatProgressBarModule {\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nexport * from './progress-bar';\nexport * from './module';\n\nexport {\n  ProgressAnimationEnd,\n  MAT_PROGRESS_BAR_LOCATION,\n  MatProgressBarLocation,\n  MAT_PROGRESS_BAR_LOCATION_FACTORY,\n} from '@angular/material/progress-bar';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}